lib "*std"

type State <- {f}

runState: i, st <- st.f: i
execState: i, st <- snd: runState: i, st
evalState: i, st <- fst: runState: i, st

unit ? r@State -> state: const: ((), s)
bind ? s@State -> state: \st -> ( ((f: a).f): sn where (a, sn) <- s.f: st end )

get <- state: \s -> (s, s)
put: s <- state: const: ((), s)
modify: f <- get bind \put: f: x
gets: f <- state: \xs -> ((f: xs), xs)
putPair: f <- state: \xs -> f: xs